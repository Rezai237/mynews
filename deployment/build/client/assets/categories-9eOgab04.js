import{w as A}from"./with-props-DRM106Ts.js";import{a as i,o as e,t as F}from"./chunk-D4RADZKF-DUJFVFZr.js";import{u as D}from"./authStore-CBBhFNwG.js";import{u as E}from"./articlesStore-C2OzSC6v.js";import{B as u}from"./Button-D7YxVoDp.js";import{I as h}from"./Input-BZbkvE__.js";import{m as b,d as p}from"./utils-Dmsv2dCC.js";import{V as l}from"./index-BvIfFWLG.js";import{A as q}from"./arrow-left-CB9Wz_nk.js";import{P as L}from"./plus-vaOFuVxj.js";import{F as P}from"./folder-ClYMstKx.js";import{S as T}from"./square-pen-C_NUI9iH.js";import{T as B}from"./trash-2-C5GLs__0.js";import"./LoadingSpinner-njtnuVwo.js";function W({}){return[{title:"Manage Categories - Admin - Techsy.News"},{name:"description",content:"Manage article categories in Techsy.News admin panel"}]}const X=A(function(){const{user:j,profile:m}=D(),{categories:g,fetchCategories:c}=E(),[N,y]=i.useState(!1),[v,n]=i.useState(!1),[d,x]=i.useState(null),[t,a]=i.useState({name:"",slug:"",description:"",color:"#3b82f6"});if(i.useEffect(()=>{c()},[c]),!j||(m==null?void 0:m.role)!=="admin")return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Access Denied"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"You don't have permission to manage categories."})]})});const f=r=>r.toLowerCase().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,""),w=async r=>{r.preventDefault(),y(!0);try{const s={name:t.name,slug:t.slug||f(t.name),description:t.description,color:t.color};if(d){const{error:o}=await p.from("categories").update(s).eq("id",d.id);if(o)throw o;l.success("Category updated successfully!")}else{const{error:o}=await p.from("categories").insert(s);if(o)throw o;l.success("Category created successfully!")}a({name:"",slug:"",description:"",color:"#3b82f6"}),n(!1),x(null),c()}catch(s){l.error(s.message||"Failed to save category")}finally{y(!1)}},k=r=>{x(r),a({name:r.name,slug:r.slug,description:r.description||"",color:r.color}),n(!0)},C=async r=>{if(confirm("Are you sure you want to delete this category?"))try{const{error:s}=await p.from("categories").delete().eq("id",r);if(s)throw s;l.success("Category deleted successfully!"),c()}catch(s){l.error(s.message||"Failed to delete category")}},S=()=>{a({name:"",slug:"",description:"",color:"#3b82f6"}),n(!1),x(null)};return e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(F,{to:"/admin",className:"p-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",children:e.jsx(q,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Manage Categories"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Organize your content with categories"})]})]}),e.jsxs(u,{onClick:()=>n(!0),children:[e.jsx(L,{className:"w-4 h-4 mr-2"}),"Add Category"]})]}),v&&e.jsxs(b.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm border border-gray-200 dark:border-gray-700 mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-6",children:d?"Edit Category":"Add New Category"}),e.jsxs("form",{onSubmit:w,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(h,{label:"Category Name",value:t.name,onChange:r=>{const s=r.target.value;a(o=>({...o,name:s,slug:f(s)}))},placeholder:"e.g., Artificial Intelligence",required:!0}),e.jsx(h,{label:"Slug",value:t.slug,onChange:r=>a(s=>({...s,slug:r.target.value})),placeholder:"e.g., artificial-intelligence",required:!0})]}),e.jsx(h,{label:"Description",value:t.description,onChange:r=>a(s=>({...s,description:r.target.value})),placeholder:"Brief description of the category"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Color"}),e.jsx("input",{type:"color",value:t.color,onChange:r=>a(s=>({...s,color:r.target.value})),className:"w-16 h-10 rounded border border-gray-300 dark:border-gray-600"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(u,{type:"submit",loading:N,children:d?"Update Category":"Create Category"}),e.jsx(u,{variant:"outline",onClick:S,children:"Cancel"})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Categories (",g.length,")"]})}),e.jsx("div",{className:"p-6",children:g.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(P,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No categories found. Create your first category to get started."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:g.map(r=>e.jsxs(b.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"p-4 rounded-lg border border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-4 h-4 rounded",style:{backgroundColor:r.color}}),e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:r.name})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>k(r),className:"p-1 text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 transition-colors",children:e.jsx(T,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>C(r.id),className:"p-1 text-gray-400 hover:text-red-600 dark:hover:text-red-400 transition-colors",children:e.jsx(B,{className:"w-4 h-4"})})]})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:r.description||"No description"}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:["Slug: ",r.slug]})]},r.id))})})]})]})})});export{X as default,W as meta};
