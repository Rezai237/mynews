import{w as b}from"./with-props-DRM106Ts.js";import{a as r,o as e,t as l}from"./chunk-D4RADZKF-DUJFVFZr.js";import{u as v}from"./authStore-CBBhFNwG.js";import{a as k,d as x,m as h,k as w}from"./utils-Dmsv2dCC.js";import"./Button-D7YxVoDp.js";import{L as _}from"./LoadingSpinner-njtnuVwo.js";import{V as n}from"./index-BvIfFWLG.js";import{A as C}from"./arrow-left-CB9Wz_nk.js";import{M as g}from"./message-square-DrCx0BaE.js";import{U as M}from"./user-bkK-Sprj.js";import{C as A}from"./calendar-sW80RKu2.js";import{E as S}from"./eye-D66ep1xE.js";import{T as D}from"./trash-2-C5GLs__0.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],L=k("external-link",E);function G({}){return[{title:"Manage Comments - Admin - Techsy.News"},{name:"description",content:"Moderate and manage comments in Techsy.News admin panel"}]}const J=b(function(){const{user:y,profile:i}=v(),[a,d]=r.useState([]),[u,c]=r.useState(!0),[m,o]=r.useState(null);if(r.useEffect(()=>{p()},[]),!y||(i==null?void 0:i.role)!=="admin")return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Access Denied"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"You don't have permission to manage comments."})]})});const p=async()=>{try{c(!0);const{data:t,error:s}=await x.from("comments").select(`
          id,
          content,
          created_at,
          user:profiles!comments_user_id_fkey(id, full_name, avatar_url),
          article:articles!comments_article_id_fkey(id, title, slug)
        `).order("created_at",{ascending:!1});if(s)throw s;d(t||[])}catch(t){console.error("Error fetching comments:",t),n.error("Failed to load comments")}finally{c(!1)}},f=async t=>{if(confirm("Are you sure you want to delete this comment?"))try{o(t);const{error:s}=await x.from("comments").delete().eq("id",t);if(s)throw s;n.success("Comment deleted successfully"),d(j=>j.filter(N=>N.id!==t))}catch(s){n.error(s.message||"Failed to delete comment")}finally{o(null)}};return u?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:e.jsx(_,{size:"lg"})}):e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(l,{to:"/admin",className:"p-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",children:e.jsx(C,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Manage Comments"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Moderate and manage user comments"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500 dark:text-gray-400",children:[e.jsx(g,{className:"w-4 h-4"}),e.jsxs("span",{children:[a.length," total comments"]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Recent Comments"})}),e.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:a.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(g,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No comments found. Comments will appear here when users start engaging with your articles."})]}):a.map((t,s)=>e.jsx(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:s*.05},className:"p-6 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[t.user.avatar_url?e.jsx("img",{src:t.user.avatar_url,alt:t.user.full_name,className:"w-8 h-8 rounded-full"}):e.jsx("div",{className:"w-8 h-8 bg-gray-300 dark:bg-gray-600 rounded-full flex items-center justify-center",children:e.jsx(M,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"})}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:t.user.full_name})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500 dark:text-gray-400",children:[e.jsx(A,{className:"w-4 h-4"}),e.jsx("span",{children:w(t.created_at)})]})]}),e.jsx("div",{className:"mb-3",children:e.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-relaxed",children:t.content})}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"On article:"}),e.jsxs(l,{to:`/article/${t.article.slug}`,className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 font-medium flex items-center space-x-1",children:[e.jsx("span",{children:t.article.title}),e.jsx(L,{className:"w-3 h-3"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx(l,{to:`/article/${t.article.slug}`,className:"p-2 text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 transition-colors",title:"View Article",children:e.jsx(S,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>f(t.id),disabled:m===t.id,className:"p-2 text-gray-400 hover:text-red-600 dark:hover:text-red-400 transition-colors disabled:opacity-50",title:"Delete Comment",children:m===t.id?e.jsx("div",{className:"w-4 h-4 border-2 border-red-600 border-t-transparent rounded-full animate-spin"}):e.jsx(D,{className:"w-4 h-4"})})]})]})},t.id))})]}),a.length>0&&e.jsxs(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"mt-8 bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Comment Statistics"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:a.length}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Comments"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:a.filter(t=>new Date(t.created_at)>new Date(Date.now()-7*24*60*60*1e3)).length}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"This Week"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:new Set(a.map(t=>t.user.id)).size}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Unique Users"})]})]})]})]})})});export{J as default,G as meta};
