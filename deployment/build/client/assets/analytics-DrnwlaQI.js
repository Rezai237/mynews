import{w as D}from"./with-props-DRM106Ts.js";import{a as h,o as e,t as E}from"./chunk-D4RADZKF-DUJFVFZr.js";import{u as S}from"./authStore-CBBhFNwG.js";import{u as U}from"./articlesStore-C2OzSC6v.js";import{d as p,n as c,f as M,m as g}from"./utils-Dmsv2dCC.js";import{E as u}from"./eye-D66ep1xE.js";import{H as j}from"./heart-BD4QhLHz.js";import{U as $,F,C as H}from"./users-DpUEI1LK.js";import{A as P}from"./arrow-left-CB9Wz_nk.js";import{C as _}from"./calendar-sW80RKu2.js";function W({}){return[{title:"Analytics - Admin - Techsy.News"},{name:"description",content:"View detailed analytics and insights for Techsy.News"}]}const X=D(function(){const{user:f,profile:o}=S(),{articles:i,categories:N}=U(),[r,b]=h.useState({totalViews:0,totalLikes:0,totalComments:0,totalUsers:0,articlesThisMonth:0,topArticles:[],topCategories:[],recentActivity:[]}),[w,y]=h.useState(!0);if(h.useEffect(()=>{v()},[i]),!f||(o==null?void 0:o.role)!=="admin")return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Access Denied"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"You don't have permission to view analytics."})]})});const v=async()=>{try{y(!0);const t=i.reduce((s,a)=>s+a.views,0),l=i.reduce((s,a)=>s+a.likes,0),n=new Date;n.setDate(1);const A=i.filter(s=>new Date(s.created_at)>=n).length,C=[...i].sort((s,a)=>a.views-s.views).slice(0,5),T=N.map(s=>{const a=i.filter(m=>m.category_id===s.id),V=a.reduce((m,L)=>m+L.views,0);return{...s,articleCount:a.length,totalViews:V}}).sort((s,a)=>a.totalViews-s.totalViews),{data:d}=await p.from("profiles").select("id"),{data:x}=await p.from("comments").select("id");b({totalViews:t,totalLikes:l,totalComments:(x==null?void 0:x.length)||0,totalUsers:(d==null?void 0:d.length)||0,articlesThisMonth:A,topArticles:C,topCategories:T.slice(0,5),recentActivity:[]})}catch(t){console.error("Error fetching analytics:",t)}finally{y(!1)}},k=[{title:"Total Views",value:c(r.totalViews),icon:u,color:"blue",change:"+12%"},{title:"Total Likes",value:c(r.totalLikes),icon:j,color:"red",change:"+8%"},{title:"Total Users",value:c(r.totalUsers),icon:$,color:"green",change:"+15%"},{title:"Articles This Month",value:r.articlesThisMonth.toString(),icon:F,color:"purple",change:"+5%"}];return w?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(H,{className:"w-12 h-12 text-gray-400 mx-auto mb-4 animate-pulse"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Loading analytics..."})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(E,{to:"/admin",className:"p-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",children:e.jsx(P,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Analytics Dashboard"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Detailed insights and performance metrics"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500 dark:text-gray-400",children:[e.jsx(_,{className:"w-4 h-4"}),e.jsxs("span",{children:["Last updated: ",M(new Date)]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:k.map((t,l)=>{const n=t.icon;return e.jsx(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:l*.1},className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:t.title}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:t.value}),e.jsxs("p",{className:"text-xs text-green-600 dark:text-green-400 mt-1",children:[t.change," from last month"]})]}),e.jsx("div",{className:`p-3 rounded-lg bg-${t.color}-100 dark:bg-${t.color}-900/20`,children:e.jsx(n,{className:`w-6 h-6 text-${t.color}-600 dark:text-${t.color}-400`})})]})},t.title)})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-6",children:"Top Performing Articles"}),e.jsx("div",{className:"space-y-4",children:r.topArticles.length>0?r.topArticles.map((t,l)=>e.jsxs("div",{className:"flex items-start space-x-3 p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-100 dark:bg-blue-900/20 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-blue-600 dark:text-blue-400",children:l+1})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:t.title}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1 text-xs text-gray-500 dark:text-gray-400",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(u,{className:"w-3 h-3 mr-1"}),c(t.views)," views"]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(j,{className:"w-3 h-3 mr-1"}),c(t.likes)," likes"]})]})]})]},t.id)):e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-8",children:"No articles data available"})})]}),e.jsxs(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-6",children:"Top Categories"}),e.jsx("div",{className:"space-y-4",children:r.topCategories.length>0?r.topCategories.map((t,l)=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-4 h-4 rounded",style:{backgroundColor:t.color}}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.name}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[t.articleCount," articles"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:c(t.totalViews)}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"views"})]})]},t.id)):e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-8",children:"No categories data available"})})]})]})]})})});export{X as default,W as meta};
